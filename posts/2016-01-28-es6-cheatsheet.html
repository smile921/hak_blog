<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <title>es6-cheatsheet</title>
        <script type="text/javascript" src="../js/favico-0.3.9.min.js"></script>
        <link rel="stylesheet" href="../css/default-highlight.css">
		<link rel="stylesheet" type="text/css" href="../css/default.css" />
        <link rel="shortcut icon" type="image/x-icon" href="../images/favicon.ico"> 
       <!-- <link rel="stylesheet" href="/css/school-book.css"> -->
        
        <script type="text/javascript" src="../js/highlight-pack.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>
    </head>
    <body>
     <header id="hd-block">
    <h1 id="adage">不为有趣之事，何以遣无涯之生</h1>
     </header>
    <div class="container-1">
        <div id="header">
            <div id="logo">
                <a href="../">曾经的脚印</a>
            </div>
            <div id="navigation">
                <a href="../">Home</a>
                <a href="../about.html">About</a>
                <a href="../contact.html">Contact</a>
                <a href="../archive.html">Archive</a>
            </div>
        </div>

        <div id="content">
            <h1>es6-cheatsheet</h1>

            <div class="info">
    Posted on January 28, 2016
    
</div>

<h1 id="es6-cheatsheet">es6-cheatsheet</h1>
<p>A cheatsheet containing ES2015 [ES6] tips, tricks, best practices and code snippet examples for your day to day workflow. Contributions are welcome!</p>
<h2 id="table-of-contents">Table of Contents</h2>
<ul>
<li><a href="#var-versus-let--const">var versus let / const</a></li>
<li><a href="#replacing-iifes-with-blocks">Replacing IIFEs with Blocks</a></li>
<li><a href="#arrow-functions">Arrow Functions</a></li>
<li><a href="#strings">Strings</a></li>
<li><a href="#destructuring">Destructuring</a></li>
<li><a href="#modules">Modules</a></li>
<li><a href="#parameters">Parameters</a></li>
<li><a href="#classes">Classes</a></li>
<li><a href="#symbols">Symbols</a></li>
<li><a href="#maps">Maps</a></li>
<li><a href="#weakmaps">WeakMaps</a></li>
<li><a href="#promises">Promises</a></li>
</ul>
<h2 id="var-versus-let-const">var versus let / const</h2>
<blockquote>
<p>Besides <code>var</code>, we now have access to two new identifiers for storing values —<code>let</code> and <code>const</code>. Unlike <code>var</code>, <code>let</code> and <code>const</code> statements are not hoisted to the top of their enclosing scope.</p>
</blockquote>
<p>An example of using <code>var</code>:</p>
<div class="sourceCode"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> snack <span class="op">=</span> <span class="st">'Meow Mix'</span><span class="op">;</span>

<span class="kw">function</span> <span class="at">getFood</span>(food) <span class="op">{</span>
    <span class="cf">if</span> (food) <span class="op">{</span>
        <span class="kw">var</span> snack <span class="op">=</span> <span class="st">'Friskies'</span><span class="op">;</span>
        <span class="cf">return</span> snack<span class="op">;</span>
    <span class="op">}</span>
    <span class="cf">return</span> snack<span class="op">;</span>
<span class="op">}</span>

<span class="at">getFood</span>(<span class="kw">false</span>)<span class="op">;</span> <span class="co">// undefined</span></code></pre></div>
<p>However, observe what happens when we replace <code>var</code> using <code>let</code>:</p>
<div class="sourceCode"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">let</span> snack <span class="op">=</span> <span class="st">'Meow Mix'</span><span class="op">;</span>

<span class="kw">function</span> <span class="at">getFood</span>(food) <span class="op">{</span>
    <span class="cf">if</span> (food) <span class="op">{</span>
        <span class="kw">let</span> snack <span class="op">=</span> <span class="st">'Friskies'</span><span class="op">;</span>
        <span class="cf">return</span> snack<span class="op">;</span>
    <span class="op">}</span>
    <span class="cf">return</span> snack<span class="op">;</span>
<span class="op">}</span>

<span class="at">getFood</span>(<span class="kw">false</span>)<span class="op">;</span> <span class="co">// 'Meow Mix'</span></code></pre></div>
<p>This change in behavior highlights that we need to be careful when refactoring legacy code which uses <code>var</code>. Blindly replacing instances of <code>var</code> with <code>let</code> may lead to unexpected behavior.</p>
<blockquote>
<p><strong>Note</strong>: <code>let</code> and <code>const</code> are block scoped. Therefore, referencing block-scoped identifiers before they are defined will produce a <code>ReferenceError</code>.</p>
</blockquote>
<div class="sourceCode"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="va">console</span>.<span class="at">log</span>(x)<span class="op">;</span>

<span class="kw">let</span> x <span class="op">=</span> <span class="st">'hi'</span><span class="op">;</span> <span class="co">// ReferenceError: x is not defined</span></code></pre></div>
<blockquote>
<p><strong>Best Practice</strong>: Leave <code>var</code> declarations inside of legacy code to denote that it needs to be carefully refactored. When working on a new codebase, use <code>let</code> for variables that will change their value over time, and <code>const</code> for variables which cannot be reassigned.</p>
</blockquote>
<p><sup><a href="#table-of-contents">(back to table of contents)</a></sup></p>
<h2 id="replacing-iifes-with-blocks">Replacing IIFEs with Blocks</h2>
<blockquote>
<p>A common use of <strong>Immediately Invoked Function Expressions</strong> is to enclose values within its scope. In ES6, we now have the ability to create block-based scopes and therefore are not limited purely to function-based scope.</p>
</blockquote>
<div class="sourceCode"><pre class="sourceCode javascript"><code class="sourceCode javascript">(<span class="kw">function</span> () <span class="op">{</span>
    <span class="kw">var</span> food <span class="op">=</span> <span class="st">'Meow Mix'</span><span class="op">;</span>
<span class="op">}</span>())<span class="op">;</span>

<span class="va">console</span>.<span class="at">log</span>(food)<span class="op">;</span> <span class="co">// Reference Error</span></code></pre></div>
<p>Using ES6 Blocks:</p>
<div class="sourceCode"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="op">{</span>
    <span class="kw">let</span> food <span class="op">=</span> <span class="st">'Meow Mix'</span><span class="op">;</span>
<span class="op">}</span>

<span class="va">console</span>.<span class="at">log</span>(food)<span class="op">;</span> <span class="co">// Reference Error</span></code></pre></div>
<p><sup><a href="#table-of-contents">(back to table of contents)</a></sup></p>
<h2 id="arrow-functions">Arrow Functions</h2>
<p>Often times we have nested functions in which we would like to preserve the context of <code>this</code> from its lexical scope. An example is shown below:</p>
<div class="sourceCode"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">function</span> <span class="at">Person</span>(name) <span class="op">{</span>
    <span class="kw">this</span>.<span class="at">name</span> <span class="op">=</span> name<span class="op">;</span>
<span class="op">}</span>

<span class="va">Person</span>.<span class="va">prototype</span>.<span class="at">prefixName</span> <span class="op">=</span> <span class="kw">function</span> (arr) <span class="op">{</span>
    <span class="cf">return</span> <span class="va">arr</span>.<span class="at">map</span>(<span class="kw">function</span> (character) <span class="op">{</span>
        <span class="cf">return</span> <span class="kw">this</span>.<span class="at">name</span> <span class="op">+</span> character<span class="op">;</span> <span class="co">// Cannot read property 'name' of undefined</span>
    <span class="op">}</span>)<span class="op">;</span>
<span class="op">};</span></code></pre></div>
<p>One common solution to this problem is to store the context of <code>this</code> using a variable:</p>
<div class="sourceCode"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">function</span> <span class="at">Person</span>(name) <span class="op">{</span>
    <span class="kw">this</span>.<span class="at">name</span> <span class="op">=</span> name<span class="op">;</span>
<span class="op">}</span>

<span class="va">Person</span>.<span class="va">prototype</span>.<span class="at">prefixName</span> <span class="op">=</span> <span class="kw">function</span> (arr) <span class="op">{</span>
    <span class="kw">var</span> that <span class="op">=</span> <span class="kw">this</span><span class="op">;</span> <span class="co">// Store the context of this</span>
    <span class="cf">return</span> <span class="va">arr</span>.<span class="at">map</span>(<span class="kw">function</span> (character) <span class="op">{</span>
        <span class="cf">return</span> <span class="va">that</span>.<span class="at">name</span> <span class="op">+</span> character<span class="op">;</span>
    <span class="op">}</span>)<span class="op">;</span>
<span class="op">};</span></code></pre></div>
<p>We can also pass in the proper context of <code>this</code>:</p>
<div class="sourceCode"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">function</span> <span class="at">Person</span>(name) <span class="op">{</span>
    <span class="kw">this</span>.<span class="at">name</span> <span class="op">=</span> name<span class="op">;</span>
<span class="op">}</span>

<span class="va">Person</span>.<span class="va">prototype</span>.<span class="at">prefixName</span> <span class="op">=</span> <span class="kw">function</span> (arr) <span class="op">{</span>
    <span class="cf">return</span> <span class="va">arr</span>.<span class="at">map</span>(<span class="kw">function</span> (character) <span class="op">{</span>
        <span class="cf">return</span> <span class="kw">this</span>.<span class="at">name</span> <span class="op">+</span> character<span class="op">;</span>
    <span class="op">},</span> <span class="kw">this</span>)<span class="op">;</span>
<span class="op">};</span></code></pre></div>
<p>As well as bind the context:</p>
<div class="sourceCode"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">function</span> <span class="at">Person</span>(name) <span class="op">{</span>
    <span class="kw">this</span>.<span class="at">name</span> <span class="op">=</span> name<span class="op">;</span>
<span class="op">}</span>

<span class="va">Person</span>.<span class="va">prototype</span>.<span class="at">prefixName</span> <span class="op">=</span> <span class="kw">function</span> (arr) <span class="op">{</span>
    <span class="cf">return</span> <span class="va">arr</span>.<span class="at">map</span>(<span class="kw">function</span> (character) <span class="op">{</span>
        <span class="cf">return</span> <span class="kw">this</span>.<span class="at">name</span> <span class="op">+</span> character<span class="op">;</span>
    <span class="op">}</span>.<span class="at">bind</span>(<span class="kw">this</span>))<span class="op">;</span>
<span class="op">};</span></code></pre></div>
<p>Using <strong>Arrow Functions</strong>, the lexical value of <code>this</code> isn’t shadowed and we can re-write the above as shown:</p>
<div class="sourceCode"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">function</span> <span class="at">Person</span>(name) <span class="op">{</span>
    <span class="kw">this</span>.<span class="at">name</span> <span class="op">=</span> name<span class="op">;</span>
<span class="op">}</span>

<span class="va">Person</span>.<span class="va">prototype</span>.<span class="at">prefixName</span> <span class="op">=</span> <span class="kw">function</span> (arr) <span class="op">{</span>
    <span class="cf">return</span> <span class="va">arr</span>.<span class="at">map</span>(character <span class="op">=&gt;</span> <span class="kw">this</span>.<span class="at">name</span> <span class="op">+</span> character)<span class="op">;</span>
<span class="op">};</span></code></pre></div>
<blockquote>
<p><strong>Best Practice</strong>: Use <strong>Arrow Functions</strong> whenever you need to preserve the lexical value of <code>this</code>.</p>
</blockquote>
<p>Arrow Functions are also more concise when used in function expressions which simply return a value:</p>
<div class="sourceCode"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> squares <span class="op">=</span> <span class="va">arr</span>.<span class="at">map</span>(<span class="kw">function</span> (x) <span class="op">{</span> <span class="cf">return</span> x <span class="op">*</span> x <span class="op">}</span>)<span class="op">;</span> <span class="co">// Function Expression</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">const</span> arr <span class="op">=</span> [<span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="dv">4</span><span class="op">,</span> <span class="dv">5</span>]<span class="op">;</span>
<span class="kw">const</span> squares <span class="op">=</span> <span class="va">arr</span>.<span class="at">map</span>(x <span class="op">=&gt;</span> x <span class="op">*</span> x)<span class="op">;</span> <span class="co">// Arrow Function for terser implementation</span></code></pre></div>
<blockquote>
<p><strong>Best Practice</strong>: Use <strong>Arrow Functions</strong> in place of function expressions when possible.</p>
</blockquote>
<p><sup><a href="#table-of-contents">(back to table of contents)</a></sup></p>
<h2 id="strings">Strings</h2>
<p>With ES6, the standard library has grown immensely. Along with these changes are new methods which can be used on strings, such as <code>.includes()</code> and <code>.repeat()</code>.</p>
<h3 id="includes">.includes( )</h3>
<div class="sourceCode"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> string <span class="op">=</span> <span class="st">'food'</span><span class="op">;</span>
<span class="kw">var</span> substring <span class="op">=</span> <span class="st">'foo'</span><span class="op">;</span>

<span class="va">console</span>.<span class="at">log</span>(<span class="va">string</span>.<span class="at">indexOf</span>(substring) <span class="op">&gt;</span> <span class="op">-</span><span class="dv">1</span>)<span class="op">;</span></code></pre></div>
<p>Instead of checking for a return value <code>&gt; -1</code> to denote string containment, we can simply use <code>.includes()</code> which will return a boolean:</p>
<div class="sourceCode"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">const</span> string <span class="op">=</span> <span class="st">'food'</span><span class="op">;</span>
<span class="kw">const</span> substring <span class="op">=</span> <span class="st">'foo'</span><span class="op">;</span>

<span class="va">console</span>.<span class="at">log</span>(<span class="va">string</span>.<span class="at">includes</span>(substring))<span class="op">;</span> <span class="co">// true</span></code></pre></div>
<h3 id="repeat">.repeat( )</h3>
<div class="sourceCode"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">function</span> <span class="at">repeat</span>(string<span class="op">,</span> count) <span class="op">{</span>
    <span class="kw">var</span> strings <span class="op">=</span> []<span class="op">;</span>
    <span class="cf">while</span>(<span class="va">strings</span>.<span class="at">length</span> <span class="op">&lt;</span> count) <span class="op">{</span>
        <span class="va">strings</span>.<span class="at">push</span>(string)<span class="op">;</span>
    <span class="op">}</span>
    <span class="cf">return</span> <span class="va">strings</span>.<span class="at">join</span>(<span class="st">''</span>)<span class="op">;</span>
<span class="op">}</span></code></pre></div>
<p>In ES6, we now have access to a terser implementation:</p>
<div class="sourceCode"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">// String.repeat(numberOfRepetitions)</span>
<span class="st">'meow'</span>.<span class="at">repeat</span>(<span class="dv">3</span>)<span class="op">;</span> <span class="co">// 'meowmeowmeow'</span></code></pre></div>
<h3 id="template-literals">Template Literals</h3>
<p>Using <strong>Template Literals</strong>, we can now construct strings that have special characters in them without needing to escape them explicitly.</p>
<div class="sourceCode"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> text <span class="op">=</span> <span class="st">&quot;This string contains </span><span class="sc">\&quot;</span><span class="st">double quotes</span><span class="sc">\&quot;</span><span class="st"> which are escaped.&quot;</span><span class="op">;</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">let</span> text <span class="op">=</span> <span class="vs">`This string contains &quot;double quotes&quot; which are escaped.`</span><span class="op">;</span></code></pre></div>
<p><strong>Template Literals</strong> also support interpolation, which makes the task of concatenating strings and values:</p>
<div class="sourceCode"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> name <span class="op">=</span> <span class="st">'Tiger'</span><span class="op">;</span>
<span class="kw">var</span> age <span class="op">=</span> <span class="dv">13</span><span class="op">;</span>

<span class="va">console</span>.<span class="at">log</span>(<span class="st">'My cat is named '</span> <span class="op">+</span> name <span class="op">+</span> <span class="st">' and is '</span> <span class="op">+</span> age <span class="op">+</span> <span class="st">' years old.'</span>)<span class="op">;</span></code></pre></div>
<p>Much simpler:</p>
<div class="sourceCode"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">const</span> name <span class="op">=</span> <span class="st">'Tiger'</span><span class="op">;</span>
<span class="kw">const</span> age <span class="op">=</span> <span class="dv">13</span><span class="op">;</span>

<span class="va">console</span>.<span class="at">log</span>(<span class="vs">`My cat is named </span><span class="sc">${</span>name<span class="sc">}</span><span class="vs"> and is </span><span class="sc">${</span>age<span class="sc">}</span><span class="vs"> years old.`</span>)<span class="op">;</span></code></pre></div>
<p>In ES5, we handled new lines as follows:</p>
<div class="sourceCode"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> text <span class="op">=</span> (
    <span class="st">'cat</span><span class="sc">\n</span><span class="st">'</span> <span class="op">+</span>
    <span class="st">'dog</span><span class="sc">\n</span><span class="st">'</span> <span class="op">+</span>
    <span class="st">'nickelodeon'</span>
)<span class="op">;</span></code></pre></div>
<p>Or:</p>
<div class="sourceCode"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> text <span class="op">=</span> [
    <span class="st">'cat'</span><span class="op">,</span>
    <span class="st">'dog'</span><span class="op">,</span>
    <span class="st">'nickelodeon'</span>
].<span class="at">join</span>(<span class="st">'</span><span class="sc">\n</span><span class="st">'</span>)<span class="op">;</span></code></pre></div>
<p><strong>Template Literals</strong> will preserve new lines for us without having to explicitly place them in:</p>
<div class="sourceCode"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">let</span> text <span class="op">=</span> ( <span class="vs">`cat</span>
<span class="vs">dog</span>
<span class="vs">nickelodeon`</span>
)<span class="op">;</span></code></pre></div>
<p><strong>Template Literals</strong> can accept expressions, as well:</p>
<div class="sourceCode"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">let</span> today <span class="op">=</span> <span class="kw">new</span> <span class="at">Date</span>()<span class="op">;</span>
<span class="kw">let</span> text <span class="op">=</span> <span class="vs">`The time and date is </span><span class="sc">${</span><span class="va">today</span>.<span class="at">toLocaleString</span>()<span class="sc">}</span><span class="vs">`</span><span class="op">;</span></code></pre></div>
<p><sup><a href="#table-of-contents">(back to table of contents)</a></sup></p>
<h2 id="destructuring">Destructuring</h2>
<p>Destructuring allows us to extract values from arrays and objects (even deeply nested) and store them in variables with a more convenient syntax.</p>
<h3 id="destructuring-arrays">Destructuring Arrays</h3>
<div class="sourceCode"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> arr <span class="op">=</span> [<span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="dv">4</span>]<span class="op">;</span>
<span class="kw">var</span> a <span class="op">=</span> arr[<span class="dv">0</span>]<span class="op">;</span>
<span class="kw">var</span> b <span class="op">=</span> arr[<span class="dv">1</span>]<span class="op">;</span>
<span class="kw">var</span> c <span class="op">=</span> arr[<span class="dv">2</span>]<span class="op">;</span>
<span class="kw">var</span> d <span class="op">=</span> arr[<span class="dv">3</span>]<span class="op">;</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">let</span> [a<span class="op">,</span> b<span class="op">,</span> c<span class="op">,</span> d] <span class="op">=</span> [<span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="dv">4</span>]<span class="op">;</span>

<span class="va">console</span>.<span class="at">log</span>(a)<span class="op">;</span> <span class="co">// 1</span>
<span class="va">console</span>.<span class="at">log</span>(b)<span class="op">;</span> <span class="co">// 2</span></code></pre></div>
<h3 id="destructuring-objects">Destructuring Objects</h3>
<div class="sourceCode"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> luke <span class="op">=</span> <span class="op">{</span> <span class="dt">occupation</span><span class="op">:</span> <span class="st">'jedi'</span><span class="op">,</span> <span class="dt">father</span><span class="op">:</span> <span class="st">'anakin'</span> <span class="op">};</span>
<span class="kw">var</span> occupation <span class="op">=</span> <span class="va">luke</span>.<span class="at">occupation</span><span class="op">;</span> <span class="co">// 'jedi'</span>
<span class="kw">var</span> father <span class="op">=</span> <span class="va">luke</span>.<span class="at">father</span><span class="op">;</span> <span class="co">// 'anakin'</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">let</span> luke <span class="op">=</span> <span class="op">{</span> <span class="dt">occupation</span><span class="op">:</span> <span class="st">'jedi'</span><span class="op">,</span> <span class="dt">father</span><span class="op">:</span> <span class="st">'anakin'</span> <span class="op">};</span>
<span class="kw">let</span> <span class="op">{</span>occupation<span class="op">,</span> father<span class="op">}</span> <span class="op">=</span> luke<span class="op">;</span>

<span class="va">console</span>.<span class="at">log</span>(occupation)<span class="op">;</span> <span class="co">// 'jedi'</span>
<span class="va">console</span>.<span class="at">log</span>(father)<span class="op">;</span> <span class="co">// 'anakin'</span></code></pre></div>
<p><sup><a href="#table-of-contents">(back to table of contents)</a></sup></p>
<h2 id="modules">Modules</h2>
<p>Prior to ES6, we used libraries such as <a href="http://browserify.org/">Browserify</a> to create modules on the client-side, and <a href="https://nodejs.org/api/modules.html#modules_module_require_id">require</a> in <strong>Node.js</strong>. With ES6, we can now directly use modules of all types (AMD and CommonJS).</p>
<h3 id="exporting-in-commonjs">Exporting in CommonJS</h3>
<div class="sourceCode"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="va">module</span>.<span class="at">exports</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span>
<span class="va">module</span>.<span class="at">exports</span> <span class="op">=</span> <span class="op">{</span> <span class="dt">foo</span><span class="op">:</span> <span class="st">'bar'</span> <span class="op">};</span>
<span class="va">module</span>.<span class="at">exports</span> <span class="op">=</span> [<span class="st">'foo'</span><span class="op">,</span> <span class="st">'bar'</span>]<span class="op">;</span>
<span class="va">module</span>.<span class="at">exports</span> <span class="op">=</span> <span class="kw">function</span> <span class="at">bar</span> () <span class="op">{};</span></code></pre></div>
<h3 id="exporting-in-es6">Exporting in ES6</h3>
<p>With ES6, we have various flavors of exporting. We can perform <strong>Named Exports</strong>:</p>
<div class="sourceCode"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="im">export</span> <span class="kw">let</span> name <span class="op">=</span> <span class="st">'David'</span><span class="op">;</span>
<span class="im">export</span> <span class="kw">let</span> age  <span class="op">=</span> <span class="dv">25</span><span class="op">;</span>​​</code></pre></div>
<p>As well as <strong>exporting a list</strong> of objects:</p>
<div class="sourceCode"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">function</span> <span class="at">sumTwo</span>(a<span class="op">,</span> b) <span class="op">{</span>
    <span class="cf">return</span> a <span class="op">+</span> b<span class="op">;</span>
<span class="op">}</span>

<span class="kw">function</span> <span class="at">sumThree</span>(a<span class="op">,</span> b<span class="op">,</span> c) <span class="op">{</span>
    <span class="cf">return</span> a <span class="op">+</span> b <span class="op">+</span> c<span class="op">;</span>
<span class="op">}</span>

<span class="im">export</span> <span class="op">{</span> sumTwo<span class="op">,</span> sumThree <span class="op">};</span></code></pre></div>
<p>We can also export a value simply by using the <code>export</code> keyword:</p>
<div class="sourceCode"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="im">export</span> <span class="kw">function</span> <span class="at">sumTwo</span>(a<span class="op">,</span> b) <span class="op">{</span>
    <span class="cf">return</span> a <span class="op">+</span> b<span class="op">;</span>
<span class="op">}</span>

<span class="im">export</span> <span class="kw">function</span> <span class="at">sumThree</span>(a<span class="op">,</span> b<span class="op">,</span> c) <span class="op">{</span>
    <span class="cf">return</span> a <span class="op">+</span> b <span class="op">+</span> c<span class="op">;</span>
<span class="op">}</span></code></pre></div>
<p>And lastly, we can <strong>export default bindings</strong>:</p>
<div class="sourceCode"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">function</span> <span class="at">sumTwo</span>(a<span class="op">,</span> b) <span class="op">{</span>
    <span class="cf">return</span> a <span class="op">+</span> b<span class="op">;</span>
<span class="op">}</span>

<span class="kw">function</span> <span class="at">sumThree</span>(a<span class="op">,</span> b<span class="op">,</span> c) <span class="op">{</span>
    <span class="cf">return</span> a <span class="op">+</span> b <span class="op">+</span> c<span class="op">;</span>
<span class="op">}</span>

<span class="kw">let</span> api <span class="op">=</span> <span class="op">{</span>
    sumTwo<span class="op">,</span>
    sumThree
<span class="op">};</span>

<span class="im">export</span> <span class="im">default</span> api<span class="op">;</span></code></pre></div>
<blockquote>
<p><strong>Best Practices</strong>: Always use the <code>export default</code> method at <strong>the end</strong> of the module. It makes it clear what is being exported, and saves time by having to figure out what name a value was exported as. More so, the common practice in CommonJS modules is to export a single value or object. By sticking to this paradigm, we make our code easily readable and allow ourselves to interpolate between CommonJS and ES6 modules.</p>
</blockquote>
<h3 id="importing-in-es6">Importing in ES6</h3>
<p>ES6 provides us with various flavors of importing. We can import an entire file:</p>
<div class="sourceCode"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="im">import</span> <span class="st">'underscore'</span><span class="op">;</span></code></pre></div>
<blockquote>
<p>It is important to note that simply <strong>importing an entire file will execute all code at the top level of that file</strong>.</p>
</blockquote>
<p>Similar to Python, we have named imports:</p>
<div class="sourceCode"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="im">import</span> <span class="op">{</span> sumTwo<span class="op">,</span> sumThree <span class="op">}</span> <span class="im">from</span> <span class="st">'math/addition'</span><span class="op">;</span></code></pre></div>
<p>We can also rename the named imports:</p>
<div class="sourceCode"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="im">import</span> <span class="op">{</span>
    sumTwo <span class="im">as</span> addTwoNumbers<span class="op">,</span>
    sumThree <span class="im">as</span> sumThreeNumbers
<span class="op">}</span> <span class="im">from</span> <span class="st">'math/addition'</span><span class="op">;</span></code></pre></div>
<p>In addition, we can <strong>import all the things</strong> (also called namespace import):</p>
<div class="sourceCode"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="im">import</span> <span class="op">*</span> <span class="im">as</span> util <span class="im">from</span> <span class="st">'math/addition'</span><span class="op">;</span></code></pre></div>
<p>Lastly, we can import a list of values from a module:</p>
<div class="sourceCode"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="im">import</span> <span class="op">*</span> <span class="im">as</span> additionUtil <span class="im">from</span> <span class="st">'math/addition'</span><span class="op">;</span>
<span class="kw">const</span> <span class="op">{</span> sumTwo<span class="op">,</span> sumThree <span class="op">}</span> <span class="op">=</span> additionUtil<span class="op">;</span></code></pre></div>
<p>When importing the default object we can choose which functions to import:</p>
<div class="sourceCode"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="im">import</span> React <span class="im">from</span> <span class="st">'react'</span><span class="op">;</span>
<span class="kw">const</span> <span class="op">{</span> Component<span class="op">,</span> PropTypes <span class="op">}</span> <span class="op">=</span> React<span class="op">;</span></code></pre></div>
<p>This can also be simplified further, using:</p>
<div class="sourceCode"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="im">import</span> React<span class="op">,</span> <span class="op">{</span> Component<span class="op">,</span> PropTypes <span class="op">}</span> <span class="im">from</span> <span class="st">'react'</span><span class="op">;</span></code></pre></div>
<blockquote>
<p><strong>Note</strong>: Values that are exported are <strong>bindings</strong>, not references. Therefore, changing the binding of a variable in one module will affect the value within the exported module. Avoid changing the public interface of these exported values.</p>
</blockquote>
<p><sup><a href="#table-of-contents">(back to table of contents)</a></sup></p>
<h2 id="parameters">Parameters</h2>
<p>In ES5, we had varying ways to handle functions which needed <strong>default values</strong>, <strong>indefinite arguments</strong>, and <strong>named parameters</strong>. With ES6, we can accomplish all of this and more using more concise syntax.</p>
<h3 id="default-parameters">Default Parameters</h3>
<div class="sourceCode"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">function</span> <span class="at">addTwoNumbers</span>(x<span class="op">,</span> y) <span class="op">{</span>
    x <span class="op">=</span> x <span class="op">||</span> <span class="dv">0</span><span class="op">;</span>
    y <span class="op">=</span> y <span class="op">||</span> <span class="dv">0</span><span class="op">;</span>
    <span class="cf">return</span> x <span class="op">+</span> y<span class="op">;</span>
<span class="op">}</span></code></pre></div>
<p>In ES6, we can simply supply default values for parameters in a function:</p>
<div class="sourceCode"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">function</span> <span class="at">addTwoNumbers</span>(x<span class="op">=</span><span class="dv">0</span><span class="op">,</span> y<span class="op">=</span><span class="dv">0</span>) <span class="op">{</span>
    <span class="cf">return</span> x <span class="op">+</span> y<span class="op">;</span>
<span class="op">}</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="at">addTwoNumbers</span>(<span class="dv">2</span><span class="op">,</span> <span class="dv">4</span>)<span class="op">;</span> <span class="co">// 6</span>
<span class="at">addTwoNumbers</span>(<span class="dv">2</span>)<span class="op">;</span> <span class="co">// 2</span>
<span class="at">addTwoNumbers</span>()<span class="op">;</span> <span class="co">// 0</span></code></pre></div>
<h3 id="rest-parameters">Rest Parameters</h3>
<p>In ES5, we handled an indefinite number of arguments like so:</p>
<div class="sourceCode"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">function</span> <span class="at">logArguments</span>() <span class="op">{</span>
    <span class="cf">for</span> (<span class="kw">var</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="va">arguments</span>.<span class="at">length</span><span class="op">;</span> i<span class="op">++</span>) <span class="op">{</span>
        <span class="va">console</span>.<span class="at">log</span>(arguments[i])<span class="op">;</span>
    <span class="op">}</span>
<span class="op">}</span></code></pre></div>
<p>Using the <strong>rest</strong> operator, we can pass in an indefinite amount of arguments:</p>
<div class="sourceCode"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">function</span> <span class="at">logArguments</span>(...<span class="at">args</span>) <span class="op">{</span>
    <span class="cf">for</span> (<span class="kw">let</span> arg of args) <span class="op">{</span>
        <span class="va">console</span>.<span class="at">log</span>(arg)<span class="op">;</span>
    <span class="op">}</span>
<span class="op">}</span></code></pre></div>
<h3 id="named-parameters">Named Parameters</h3>
<p>One of the patterns in ES5 to handle named parameters was to use the <strong>options object</strong> pattern, adopted from jQuery.</p>
<div class="sourceCode"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">function</span> <span class="at">initializeCanvas</span>(options) <span class="op">{</span>
    <span class="kw">var</span> height <span class="op">=</span> <span class="va">options</span>.<span class="at">height</span> <span class="op">||</span> <span class="dv">600</span><span class="op">;</span>
    <span class="kw">var</span> width  <span class="op">=</span> <span class="va">options</span>.<span class="at">width</span>  <span class="op">||</span> <span class="dv">400</span><span class="op">;</span>
    <span class="kw">var</span> lineStroke <span class="op">=</span> <span class="va">options</span>.<span class="at">lineStroke</span> <span class="op">||</span> <span class="st">'black'</span><span class="op">;</span>
<span class="op">}</span></code></pre></div>
<p>We can achieve the same functionality using destructuring as a formal parameter to a function:</p>
<div class="sourceCode"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">function</span> <span class="at">initializeCanvas</span>(
    <span class="op">{</span> height<span class="op">=</span><span class="dv">600</span><span class="op">,</span> width<span class="op">=</span><span class="dv">400</span><span class="op">,</span> lineStroke<span class="op">=</span><span class="st">'black'</span><span class="op">}</span>) <span class="op">{</span>
        <span class="co">// Use variables height, width, lineStroke here</span>
    <span class="op">}</span></code></pre></div>
<p>If we want to make the entire value optional, we can do so by destructuring an empty object:</p>
<div class="sourceCode"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">function</span> <span class="at">initializeCanvas</span>(
    <span class="op">{</span> height<span class="op">=</span><span class="dv">600</span><span class="op">,</span> width<span class="op">=</span><span class="dv">400</span><span class="op">,</span> lineStroke<span class="op">=</span><span class="st">'black'</span><span class="op">}</span> <span class="op">=</span> <span class="op">{}</span>) <span class="op">{</span>
        <span class="co">// ...</span>
    <span class="op">}</span></code></pre></div>
<h3 id="spread-operator">Spread Operator</h3>
<p>We can use the spread operator to pass an array of values to be used as parameters to a function:</p>
<div class="sourceCode"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="va">Math</span>.<span class="at">max</span>(...[<span class="op">-</span><span class="dv">1</span><span class="op">,</span> <span class="dv">100</span><span class="op">,</span> <span class="dv">9001</span><span class="op">,</span> <span class="op">-</span><span class="dv">32</span>])<span class="op">;</span> <span class="co">// 9001</span></code></pre></div>
<p><sup><a href="#table-of-contents">(back to table of contents)</a></sup></p>
<h2 id="classes">Classes</h2>
<p>Prior to ES6, we implemented Classes by creating a constructor function and adding properties by extending the prototype:</p>
<div class="sourceCode"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">function</span> <span class="at">Person</span>(name<span class="op">,</span> age<span class="op">,</span> gender) <span class="op">{</span>
    <span class="kw">this</span>.<span class="at">name</span>   <span class="op">=</span> name<span class="op">;</span>
    <span class="kw">this</span>.<span class="at">age</span>    <span class="op">=</span> age<span class="op">;</span>
    <span class="kw">this</span>.<span class="at">gender</span> <span class="op">=</span> gender<span class="op">;</span>
<span class="op">}</span>

<span class="va">Person</span>.<span class="va">prototype</span>.<span class="at">incrementAge</span> <span class="op">=</span> <span class="kw">function</span> () <span class="op">{</span>
    <span class="cf">return</span> <span class="kw">this</span>.<span class="at">age</span> <span class="op">+=</span> <span class="dv">1</span><span class="op">;</span>
<span class="op">};</span></code></pre></div>
<p>And created extended classes by the following:</p>
<div class="sourceCode"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">function</span> <span class="at">Personal</span>(name<span class="op">,</span> age<span class="op">,</span> gender<span class="op">,</span> occupation<span class="op">,</span> hobby) <span class="op">{</span>
    <span class="va">Person</span>.<span class="at">call</span>(<span class="kw">this</span><span class="op">,</span> name<span class="op">,</span> age<span class="op">,</span> gender)<span class="op">;</span>
    <span class="kw">this</span>.<span class="at">occupation</span> <span class="op">=</span> occupation<span class="op">;</span>
    <span class="kw">this</span>.<span class="at">hobby</span> <span class="op">=</span> hobby<span class="op">;</span>
<span class="op">}</span>

<span class="va">Personal</span>.<span class="at">prototype</span> <span class="op">=</span> <span class="va">Object</span>.<span class="at">create</span>(<span class="va">Person</span>.<span class="at">prototype</span>)<span class="op">;</span>
<span class="va">Personal</span>.<span class="va">prototype</span>.<span class="at">constructor</span> <span class="op">=</span> Personal<span class="op">;</span>
<span class="va">Personal</span>.<span class="va">prototype</span>.<span class="at">incrementAge</span> <span class="op">=</span> <span class="kw">function</span> () <span class="op">{</span>
    <span class="cf">return</span> <span class="va">Person</span>.<span class="va">prototype</span>.<span class="va">incrementAge</span>.<span class="at">call</span>(<span class="kw">this</span>) <span class="op">+=</span> <span class="dv">20</span><span class="op">;</span>
<span class="op">};</span></code></pre></div>
<p>ES6 provides much needed syntactic sugar for doing this under the hood. We can create Classes directly:</p>
<div class="sourceCode"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">class</span> Person <span class="op">{</span>
    <span class="at">constructor</span>(name<span class="op">,</span> age<span class="op">,</span> gender) <span class="op">{</span>
        <span class="kw">this</span>.<span class="at">name</span>   <span class="op">=</span> name<span class="op">;</span>
        <span class="kw">this</span>.<span class="at">age</span>    <span class="op">=</span> age<span class="op">;</span>
        <span class="kw">this</span>.<span class="at">gender</span> <span class="op">=</span> gender<span class="op">;</span>
    <span class="op">}</span>

    <span class="at">incrementAge</span>() <span class="op">{</span>
      <span class="kw">this</span>.<span class="at">age</span> <span class="op">+=</span> <span class="dv">1</span><span class="op">;</span>
    <span class="op">}</span>
<span class="op">}</span></code></pre></div>
<p>And extend them using the <code>extends</code> keyword:</p>
<div class="sourceCode"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">class</span> Personal <span class="kw">extends</span> Person <span class="op">{</span>
    <span class="at">constructor</span>(name<span class="op">,</span> age<span class="op">,</span> gender<span class="op">,</span> occupation<span class="op">,</span> hobby) <span class="op">{</span>
        <span class="kw">super</span>(name<span class="op">,</span> age<span class="op">,</span> gender)<span class="op">;</span>
        <span class="kw">this</span>.<span class="at">occupation</span> <span class="op">=</span> occupation<span class="op">;</span>
        <span class="kw">this</span>.<span class="at">hobby</span> <span class="op">=</span> hobby<span class="op">;</span>
    <span class="op">}</span>

    <span class="at">incrementAge</span>() <span class="op">{</span>
        <span class="kw">super</span>.<span class="at">incrementAge</span>()<span class="op">;</span>
        <span class="kw">this</span>.<span class="at">age</span> <span class="op">+=</span> <span class="dv">20</span><span class="op">;</span>
        <span class="va">console</span>.<span class="at">log</span>(<span class="kw">this</span>.<span class="at">age</span>)<span class="op">;</span>
    <span class="op">}</span>
<span class="op">}</span></code></pre></div>
<blockquote>
<p><strong>Best Practice</strong>: While the syntax for creating classes in ES6 obscures how implementation and prototypes work under the hood, it is a good feature for beginners and allows us to write cleaner code.</p>
</blockquote>
<p><sup><a href="#table-of-contents">(back to table of contents)</a></sup></p>
<h2 id="symbols">Symbols</h2>
<p>Symbols have existed prior to ES6, but now we have a public interface to using them directly. Symbols are immutable and unique and can be used as keys in any hash.</p>
<h3 id="symbol">Symbol( )</h3>
<p>Calling <code>Symbol()</code> or <code>Symbol(description)</code> will create a unique symbol that cannot be looked up globally. A Use case for <code>Symbol()</code> is to patch objects or namespaces from third parties with your own logic, but be confident that you won’t collide with updates to that library. For example, if you wanted to add a method <code>refreshComponent</code> to the <code>React.Component</code> class, and be certain that you didn’t trample a method they add in a later update:</p>
<div class="sourceCode"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">const</span> refreshComponent <span class="op">=</span> <span class="at">Symbol</span>()<span class="op">;</span>

<span class="va">React</span>.<span class="va">Component</span>.<span class="at">prototype</span>[refreshComponent] <span class="op">=</span> () <span class="op">=&gt;</span> <span class="op">{</span>
    <span class="co">// do something</span>
<span class="op">}</span></code></pre></div>
<h3 id="symbol.forkey">Symbol.for(key)</h3>
<p><code>Symbol.for(key)</code> will create a Symbol that is still immutable and unique, but can be looked up globally. Two identical calls to <code>Symbol.for(key)</code> will return the same Symbol instance. NOTE: This is not true for <code>Symbol(description)</code>:</p>
<div class="sourceCode"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="at">Symbol</span>(<span class="st">'foo'</span>) <span class="op">===</span> <span class="at">Symbol</span>(<span class="st">'foo'</span>) <span class="co">// false</span>
<span class="va">Symbol</span>.<span class="at">for</span>(<span class="st">'foo'</span>) <span class="op">===</span> <span class="at">Symbol</span>(<span class="st">'foo'</span>) <span class="co">// false</span>
<span class="va">Symbol</span>.<span class="at">for</span>(<span class="st">'foo'</span>) <span class="op">===</span> <span class="va">Symbol</span>.<span class="at">for</span>(<span class="st">'foo'</span>) <span class="co">// true</span></code></pre></div>
<p>A common use case for Symbols, and in particular with <code>Symbol.for(key)</code> is for interoperability. This can be acheived by having your code look for a Symbol member on object arguments from third parties that contain some known interface. For example:</p>
<div class="sourceCode"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">function</span> <span class="at">reader</span>(obj) <span class="op">{</span>
    <span class="kw">const</span> specialRead <span class="op">=</span> <span class="va">Symbol</span>.<span class="at">for</span>(<span class="st">'specialRead'</span>)<span class="op">;</span>
    <span class="cf">if</span> (obj[specialRead]) <span class="op">{</span>
        <span class="kw">const</span> reader <span class="op">=</span> obj[specialRead]()<span class="op">;</span>
        <span class="co">// do something with reader</span>
    <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span>
        <span class="cf">throw</span> <span class="kw">new</span> <span class="at">TypeError</span>(<span class="st">'object cannot be read'</span>)<span class="op">;</span>
    <span class="op">}</span>
<span class="op">}</span></code></pre></div>
<p>And then in another library:</p>
<div class="sourceCode"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">const</span> specialRead <span class="op">=</span> <span class="va">Symbol</span>.<span class="at">for</span>(<span class="st">'specialRead'</span>)<span class="op">;</span>

<span class="kw">class</span> SomeReadableType <span class="op">{</span>
    [specialRead]() <span class="op">{</span>
        <span class="kw">const</span> reader <span class="op">=</span> <span class="at">createSomeReaderFrom</span>(<span class="kw">this</span>)<span class="op">;</span>
        <span class="cf">return</span> reader<span class="op">;</span>
    <span class="op">}</span>
<span class="op">}</span></code></pre></div>
<blockquote>
<p>A notable example of Symbol use for interoperability is <code>Symbol.iterable</code> which exists on all iterable and iterator types in ES6: Arrays, strings, generators, etc. When called as a method it returns an object with an Iterator interface.</p>
</blockquote>
<p><sup><a href="#table-of-contents">(back to table of contents)</a></sup></p>
<h2 id="maps">Maps</h2>
<p><strong>Maps</strong> is a much needed data structure in JavaScript. Prior to ES6, we created <strong>hash</strong> maps through objects:</p>
<div class="sourceCode"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> map <span class="op">=</span> <span class="kw">new</span> <span class="at">Object</span>()<span class="op">;</span>
map[key1] <span class="op">=</span> <span class="st">'value1'</span><span class="op">;</span>
map[key2] <span class="op">=</span> <span class="st">'value2'</span><span class="op">;</span></code></pre></div>
<p>However, this does not protect us from accidentally overriding functions with specific property names:</p>
<div class="sourceCode"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="op">&gt;</span> <span class="at">getOwnProperty</span>(<span class="op">{</span> <span class="dt">hasOwnProperty</span><span class="op">:</span> <span class="st">'Hah, overwritten'</span><span class="op">},</span> <span class="st">'Pwned'</span>)<span class="op">;</span>
<span class="op">&gt;</span> TypeError<span class="op">:</span> Property <span class="st">'hasOwnProperty'</span> is not a <span class="kw">function</span></code></pre></div>
<p>Actual <strong>Maps</strong> allow us to <code>set</code>, <code>get</code> and <code>search</code> for values (and much more).</p>
<div class="sourceCode"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">let</span> map <span class="op">=</span> <span class="kw">new</span> <span class="at">Map</span>()<span class="op">;</span>
<span class="op">&gt;</span> <span class="va">map</span>.<span class="at">set</span>(<span class="st">'name'</span><span class="op">,</span> <span class="st">'david'</span>)<span class="op">;</span>
<span class="op">&gt;</span> <span class="va">map</span>.<span class="at">get</span>(<span class="st">'name'</span>)<span class="op">;</span> <span class="co">// david</span>
<span class="op">&gt;</span> <span class="va">map</span>.<span class="at">has</span>(<span class="st">'name'</span>)<span class="op">;</span> <span class="co">// true</span></code></pre></div>
<p>The most amazing part of Maps is that we are no longer limited to just using strings. We can now use any type as a key, and it will not be type-casted to a string.</p>
<div class="sourceCode"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">let</span> map <span class="op">=</span> <span class="kw">new</span> <span class="at">Map</span>([
    [<span class="st">'name'</span><span class="op">,</span> <span class="st">'david'</span>]<span class="op">,</span>
    [<span class="kw">true</span><span class="op">,</span> <span class="st">'false'</span>]<span class="op">,</span>
    [<span class="dv">1</span><span class="op">,</span> <span class="st">'one'</span>]<span class="op">,</span>
    [<span class="op">{},</span> <span class="st">'object'</span>]<span class="op">,</span>
    [<span class="kw">function</span> () <span class="op">{},</span> <span class="st">'function'</span>]
])<span class="op">;</span>

<span class="cf">for</span> (<span class="kw">let</span> key of <span class="va">map</span>.<span class="at">keys</span>()) <span class="op">{</span>
    <span class="va">console</span>.<span class="at">log</span>(<span class="kw">typeof</span> key)<span class="op">;</span>
    <span class="co">// &gt; string, boolean, number, object, function</span>
<span class="op">}</span></code></pre></div>
<blockquote>
<p><strong>Note</strong>: Using non-primitive values such as functions or objects won’t work when testing equality using methods such as <code>map.get()</code>. As such, stick to primitive values such as Strings, Booleans and Numbers.</p>
</blockquote>
<p>We can also iterate over maps using <code>.entries()</code>:</p>
<div class="sourceCode"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="cf">for</span> (<span class="kw">let</span> [key<span class="op">,</span> value] of <span class="va">map</span>.<span class="at">entries</span>()) <span class="op">{</span>
    <span class="va">console</span>.<span class="at">log</span>(key<span class="op">,</span> value)<span class="op">;</span>
<span class="op">}</span></code></pre></div>
<p><sup><a href="#table-of-contents">(back to table of contents)</a></sup></p>
<h2 id="weakmaps">WeakMaps</h2>
<p>In order to store private data in &lt; ES5, we had various ways of doing this. One such method was using naming conventions:</p>
<div class="sourceCode"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">class</span> Person <span class="op">{</span>
    <span class="at">constructor</span>(age) <span class="op">{</span>
        <span class="kw">this</span>.<span class="at">_age</span> <span class="op">=</span> age<span class="op">;</span>
    <span class="op">}</span>

    <span class="at">_incrementAge</span>() <span class="op">{</span>
        <span class="kw">this</span>.<span class="at">_age</span> <span class="op">+=</span> <span class="dv">1</span><span class="op">;</span>
    <span class="op">}</span>
<span class="op">}</span></code></pre></div>
<p>But naming conventions can cause confusion in a codebase and are not always going to be upheld. Instead, we can use WeakMaps to store our values:</p>
<div class="sourceCode"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">let</span> _age <span class="op">=</span> <span class="kw">new</span> <span class="at">WeakMap</span>()<span class="op">;</span>
<span class="kw">class</span> Person <span class="op">{</span>
    <span class="at">constructor</span>(age) <span class="op">{</span>
        <span class="va">_age</span>.<span class="at">set</span>(<span class="kw">this</span><span class="op">,</span> age)<span class="op">;</span>
    <span class="op">}</span>

    <span class="at">incrementAge</span>() <span class="op">{</span>
        <span class="kw">let</span> age <span class="op">=</span> <span class="va">_age</span>.<span class="at">get</span>(<span class="kw">this</span>) <span class="op">+</span> <span class="dv">1</span><span class="op">;</span>
        <span class="va">_age</span>.<span class="at">set</span>(<span class="kw">this</span><span class="op">,</span> age)<span class="op">;</span>
        <span class="cf">if</span> (age <span class="op">&gt;</span> <span class="dv">50</span>) <span class="op">{</span>
            <span class="va">console</span>.<span class="at">log</span>(<span class="st">'Midlife crisis'</span>)<span class="op">;</span>
        <span class="op">}</span>
    <span class="op">}</span>
<span class="op">}</span></code></pre></div>
<p>The cool thing about using WeakMaps to store our private data is that their keys do not give away the property names, which can be seen by using <code>Reflect.ownKeys()</code>:</p>
<div class="sourceCode"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="op">&gt;</span> <span class="kw">const</span> person <span class="op">=</span> <span class="kw">new</span> <span class="at">Person</span>(<span class="dv">50</span>)<span class="op">;</span>
<span class="op">&gt;</span> <span class="va">person</span>.<span class="at">incrementAge</span>()<span class="op">;</span> <span class="co">// 'Midlife crisis'</span>
<span class="op">&gt;</span> <span class="va">Reflect</span>.<span class="at">ownKeys</span>(person)<span class="op">;</span> <span class="co">// []</span></code></pre></div>
<p>A more practical example of using WeakMaps is to store data which is associated to a DOM element without having to pollute the DOM itself:</p>
<div class="sourceCode"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">let</span> map <span class="op">=</span> <span class="kw">new</span> <span class="at">WeakMap</span>()<span class="op">;</span>
<span class="kw">let</span> el  <span class="op">=</span> <span class="va">document</span>.<span class="at">getElementById</span>(<span class="st">'someElement'</span>)<span class="op">;</span>

<span class="co">// Store a weak reference to the element with a key</span>
<span class="va">map</span>.<span class="at">set</span>(el<span class="op">,</span> <span class="st">'reference'</span>)<span class="op">;</span>

<span class="co">// Access the value of the element</span>
<span class="kw">let</span> value <span class="op">=</span> <span class="va">map</span>.<span class="at">get</span>(el)<span class="op">;</span> <span class="co">// 'reference'</span>

<span class="co">// Remove the reference</span>
<span class="va">el</span>.<span class="va">parentNode</span>.<span class="at">removeChild</span>(el)<span class="op">;</span>
el <span class="op">=</span> <span class="kw">null</span><span class="op">;</span>

value <span class="op">=</span> <span class="va">map</span>.<span class="at">get</span>(el)<span class="op">;</span> <span class="co">// undefined</span></code></pre></div>
<p>As shown above, once the object is is destroyed by the garbage collector, the WeakMap will automatically remove the key-value pair which was identified by that object.</p>
<blockquote>
<p><strong>Note</strong>: To further illustrate the usefulness of this example, consider how jQuery stores a cache of objects corresponding to DOM elements which have references. Using WeakMaps, jQuery can automatically free up any memory that was associated with a particular DOM element once it has been removed from the document. In general, WeakMaps are very useful for any library that wraps DOM elements.</p>
</blockquote>
<p><sup><a href="#table-of-contents">(back to table of contents)</a></sup></p>
<h2 id="promises">Promises</h2>
<p>Promises allow us to turn our horizontal code (callback hell):</p>
<div class="sourceCode"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="at">func1</span>(<span class="kw">function</span> (value1) <span class="op">{</span>
    <span class="at">func2</span>(value1<span class="op">,</span> <span class="kw">function</span> (value2) <span class="op">{</span>
        <span class="at">func3</span>(value2<span class="op">,</span> <span class="kw">function</span> (value3) <span class="op">{</span>
            <span class="at">func4</span>(value3<span class="op">,</span> <span class="kw">function</span> (value4) <span class="op">{</span>
                <span class="at">func5</span>(value4<span class="op">,</span> <span class="kw">function</span> (value5) <span class="op">{</span>
                    <span class="co">// Do something with value 5</span>
                <span class="op">}</span>)<span class="op">;</span>
            <span class="op">}</span>)<span class="op">;</span>
        <span class="op">}</span>)<span class="op">;</span>
    <span class="op">}</span>)<span class="op">;</span>
<span class="op">}</span>)<span class="op">;</span></code></pre></div>
<p>Into vertical code:</p>
<div class="sourceCode"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="at">func1</span>(value1)
    .<span class="at">then</span>(func2)
    .<span class="at">then</span>(func3)
    .<span class="at">then</span>(func4)
    .<span class="at">then</span>(func5<span class="op">,</span> value5 <span class="op">=&gt;</span> <span class="op">{</span>
        <span class="co">// Do something with value 5</span>
    <span class="op">}</span>)<span class="op">;</span></code></pre></div>
<p>Prior to ES6, we used <a href="https://github.com/petkaantonov/bluebird">bluebird</a> or <a href="https://github.com/kriskowal/q">Q</a>. Now we have Promises natively:</p>
<div class="sourceCode"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">new</span> <span class="at">Promise</span>((resolve<span class="op">,</span> reject) <span class="op">=&gt;</span>
    <span class="at">reject</span>(<span class="kw">new</span> <span class="at">Error</span>(<span class="st">'Failed to fulfill Promise'</span>)))
        .<span class="at">catch</span>(reason <span class="op">=&gt;</span> <span class="va">console</span>.<span class="at">log</span>(reason))<span class="op">;</span></code></pre></div>
<p>Where we have two handlers, <strong>resolve</strong> (a function called when the Promise is <strong>fulfilled</strong>) and <strong>reject</strong> (a function called when the Promise is <strong>rejected</strong>).</p>
<blockquote>
<p><strong>Benefits of Promises</strong>: Error Handling using a bunch of nested callbacks can get chaotic. Using Promises, we have a clear path to bubbling errors up and handling them appropriately. Moreover, the value of a Promise after it has been resolved/rejected is immutable - it will never change.</p>
</blockquote>
<p>Here is a practical example of using Promises:</p>
<div class="sourceCode"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> fetchJSON <span class="op">=</span> <span class="kw">function</span>(url) <span class="op">{</span>
    <span class="cf">return</span> <span class="kw">new</span> <span class="at">Promise</span>((resolve<span class="op">,</span> reject) <span class="op">=&gt;</span> <span class="op">{</span>
        <span class="va">$</span>.<span class="at">getJSON</span>(url)
            .<span class="at">done</span>((json) <span class="op">=&gt;</span> <span class="at">resolve</span>(json))
            .<span class="at">fail</span>((xhr<span class="op">,</span> status<span class="op">,</span> err) <span class="op">=&gt;</span> <span class="at">reject</span>(status <span class="op">+</span> <span class="va">err</span>.<span class="at">message</span>))<span class="op">;</span>
    <span class="op">}</span>)<span class="op">;</span>
<span class="op">};</span></code></pre></div>
<p>We can also <strong>parallelize</strong> Promises to handle an array of asynchronous operations by using <code>Promise.all()</code>:</p>
<div class="sourceCode"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> urls <span class="op">=</span> [
    <span class="st">'http://www.api.com/items/1234'</span><span class="op">,</span>
    <span class="st">'http://www.api.com/items/4567'</span>
]<span class="op">;</span>

<span class="kw">var</span> urlPromises <span class="op">=</span> <span class="va">urls</span>.<span class="at">map</span>(fetchJSON)<span class="op">;</span>

<span class="va">Promise</span>.<span class="at">all</span>(urlPromises)
    .<span class="at">then</span>(<span class="kw">function</span> (results) <span class="op">{</span>
        <span class="va">results</span>.<span class="at">forEach</span>(<span class="kw">function</span> (data) <span class="op">{</span>
        <span class="op">}</span>)<span class="op">;</span>
    <span class="op">}</span>)
    .<span class="at">catch</span>(<span class="kw">function</span> (err) <span class="op">{</span>
        <span class="va">console</span>.<span class="at">log</span>(<span class="st">'Failed: '</span><span class="op">,</span> err)<span class="op">;</span>
    <span class="op">}</span>)<span class="op">;</span></code></pre></div>

        </div>
        <script type="text/javascript">

                var favicon=new Favico({
                    bgColor : '#5CB85C',
                    textColor : '#ff0',
                });
                favicon.badge(921);
        </script>
        </div>

     
 <footer class="footer">
        <div class="fcontainer">
            <div class="site-title-wrapper">
                <h1 class="site-title-another "><a title="首页" href="../">首页</a><span>|</span></h1>
                <h1 class="site-title-another "><a title="咖啡" href="../">咖啡</a><span>|</span></h1>
                <h1 class="site-title-another "><a title="博客" href="http://smile921.github.io/ruhaskell/">博客</a></h1>
            </div>

            <p class="footer-copyright">© 2015 / smile921,&nbsp;&nbsp;ALL RIGHTS RESERVED.&nbsp;&nbsp;PUBLISHED WITH  <a href="http://jaspervdj.be/hakyll">Hakyll</a></p>
        </div>
</footer>
    </body>
</html>
